<h1>Assignments</h1>
<% form_remote_tag :url => {:action => "search_assignments", :query=>@query},:update=>'results'  do %>
  <table>
  <% @ctr = 0 %>
  <% if @assignments %>
  <% for @assignment in @assignments %>
     <% @id = @assignment.id %>
     <% if params[:note].to_i == @id.to_i %>
         <tr><td colspan = "9">Notes for <%= @assignment.project %> <%= @assignment.ExpoCode %> </td></tr>  
        <tr><td colspan = "9"><%= text_area("assignment[]",'notes',"rows" => 10,"cols" => 80) %></td></tr>
     <% end %>
    <% if params[:history].to_i == @id.to_i %>
         <tr><td colspan = "9">History for <%= @assignment.project %> <%= @assignment.ExpoCode %> </td></tr>  
        <tr><td colspan = "9"><%= text_area("assignment[]",'history',"rows" => 10,"cols" => 80,"readonly" => true) %></td></tr>
     <% end %>
  <% end %>
  <% for @assignment in @assignments %>
  <% @id = @assignment.id %>
  <% if @ctr == 0 %>
  <tr>
    <td><%= link_to_remote "ExpoCode", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "ExpoCode" } %></td>
    <td><%= link_to_remote "Project/Line", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "project" } %></td>
    <td><%= link_to_remote "Parameter", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "parameter" } %></td>
    <td><%= link_to_remote "Responsible", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "cchdo_contact" } %></td>
      <td><%= link_to_remote "Contact", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "data_contact" } %></td>
      <td><%= link_to_remote "Status", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "current_status" } %> </td>
      <td><%= link_to_remote "Action", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "action" } %> </td>
      <td><%= link_to_remote "Priority", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "priority" } %></td>
      <td><%= link_to_remote "Deadline", :update => "results",:url => { :action => "search_assignments", :query => @query, :Sort => "deadline" } %></td>
      <td></td>
      <td></td>
   </tr>
  <% end %>
  <tr>
  <td><%= text_field("assignment[]", 'ExpoCode',"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'project' ,"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'parameter' ,"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'cchdo_contact' ,"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'data_contact',"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'current_status',"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'action',"size" => 10) %></td>
  <td><%= text_field("assignment[]", 'priority',"size" => 5) %></td>
  <td><%= text_field("assignment[]", 'deadline',"size" => 10) %></td>
  <td><%= link_to_remote "Notes", :update => "results",:url => { :action => "search_assignments", :query => @query ,:note => @id} %></td>
  <td><%= link_to_remote "History", :update => "results",:url => { :action => "search_assignments", :query => @query ,:history => @id} %>
    <%= hidden_field("assignment[]", 'manager',"value"=> "#{@user}") %>
    </td>
  </tr>
  <% @ctr = @ctr +1 %>
  <% end %>
    <tr><td colspan="6"><%= submit_tag %></td></tr>
  <% end %>
   </table>
<% end %>

<div id="past_due">
  <%= render :partial  => "past_due", :update =>"past_due" %>
</div>
