;(function($){$.fn.ajaxSubmit=function(options){if(!this.length){log('ajaxSubmit: skipping submit process - no element selected');return this;}
if(typeof options=='function'){options={success:options};}
var action=this.attr('action');var url=(typeof action==='string')?$.trim(action):'';if(url){url=(url.match(/^([^#]+)/)||[])[1];}
url=url||window.location.href||'';options=$.extend(true,{url:url,success:$.ajaxSettings.success,type:this[0].getAttribute('method')||'GET',iframeSrc:/^https/i.test(window.location.href||'')?'javascript:false':'about:blank'},options);var veto={};this.trigger('form-pre-serialize',[this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');return this;}
if(options.beforeSerialize&&options.beforeSerialize(this,options)===false){log('ajaxSubmit: submit aborted via beforeSerialize callback');return this;}
var n,v,a=this.formToArray(options.semantic);if(options.data){options.extraData=options.data;for(n in options.data){if(options.data[n]instanceof Array){for(var k in options.data[n]){a.push({name:n,value:options.data[n][k]});}}
else{v=options.data[n];v=$.isFunction(v)?v():v;a.push({name:n,value:v});}}}
if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false){log('ajaxSubmit: submit aborted via beforeSubmit callback');return this;}
this.trigger('form-submit-validate',[a,this,options,veto]);if(veto.veto){log('ajaxSubmit: submit vetoed via form-submit-validate trigger');return this;}
var q=$.param(a);if(options.type.toUpperCase()=='GET'){options.url+=(options.url.indexOf('?')>=0?'&':'?')+q;options.data=null;}
else{options.data=q;}
var $form=this,callbacks=[];if(options.resetForm){callbacks.push(function(){$form.resetForm();});}
if(options.clearForm){callbacks.push(function(){$form.clearForm();});}
if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?'replaceWith':'html';$(options.target)[fn](data).each(oldSuccess,arguments);});}
else if(options.success){callbacks.push(options.success);}
options.success=function(data,status,xhr){var context=options.context||options;for(var i=0,max=callbacks.length;i<max;i++){callbacks[i].apply(context,[data,status,xhr||$form,$form]);}};var fileInputs=$('input:file',this).length>0;var mp='multipart/form-data';var multipart=($form.attr('enctype')==mp||$form.attr('encoding')==mp);if(options.iframe!==false&&(fileInputs||options.iframe||multipart)){if(options.closeKeepAlive){$.get(options.closeKeepAlive,fileUpload);}
else{fileUpload();}}
else{$.ajax(options);}
this.trigger('form-submit-notify',[this,options]);return this;function fileUpload(){var form=$form[0];if($(':input[name=submit],:input[id=submit]',form).length){alert('Error: Form elements must not have name or id of "submit".');return;}
var s=$.extend(true,{},$.ajaxSettings,options);s.context=s.context||s;var id='jqFormIO'+(new Date().getTime()),fn='_'+id;var $io=$('<iframe id="'+id+'" name="'+id+'" src="'+s.iframeSrc+'" />');var io=$io[0];$io.css({position:'absolute',top:'-1000px',left:'-1000px'});var xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:'n/a',getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e=(status==='timeout'?'timeout':'aborted');log('aborting upload... '+e);this.aborted=1;$io.attr('src',s.iframeSrc);xhr.error=e;s.error&&s.error.call(s.context,xhr,e,e);g&&$.event.trigger("ajaxError",[xhr,s,e]);s.complete&&s.complete.call(s.context,xhr,e);}};var g=s.global;if(g&&!$.active++){$.event.trigger("ajaxStart");}
if(g){$.event.trigger("ajaxSend",[xhr,s]);}
if(s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===false){if(s.global){$.active--;}
return;}
if(xhr.aborted){return;}
var timedOut=0,timeoutHandle;var sub=form.clk;if(sub){var n=sub.name;if(n&&!sub.disabled){s.extraData=s.extraData||{};s.extraData[n]=sub.value;if(sub.type=="image"){s.extraData[n+'.x']=form.clk_x;s.extraData[n+'.y']=form.clk_y;}}}
function doSubmit(){var t=$form.attr('target'),a=$form.attr('action');form.setAttribute('target',id);if(form.getAttribute('method')!='POST'){form.setAttribute('method','POST');}
if(form.getAttribute('action')!=s.url){form.setAttribute('action',s.url);}
if(!s.skipEncodingOverride){$form.attr({encoding:'multipart/form-data',enctype:'multipart/form-data'});}
if(s.timeout){timeoutHandle=setTimeout(function(){timedOut=true;cb(true);},s.timeout);}
var extraInputs=[];try{if(s.extraData){for(var n in s.extraData){extraInputs.push($('<input type="hidden" name="'+n+'" value="'+s.extraData[n]+'" />').appendTo(form)[0]);}}
$io.appendTo('body');io.attachEvent?io.attachEvent('onload',cb):io.addEventListener('load',cb,false);form.submit();}
finally{form.setAttribute('action',a);if(t){form.setAttribute('target',t);}else{$form.removeAttr('target');}
$(extraInputs).remove();}}
if(s.forceSync){doSubmit();}
else{setTimeout(doSubmit,10);}
var data,doc,domCheckCount=50,callbackProcessed;function cb(e){if(xhr.aborted||callbackProcessed){return;}
if(e===true&&xhr){xhr.abort('timeout');return;}
var doc=io.contentWindow?io.contentWindow.document:io.contentDocument?io.contentDocument:io.document;if(!doc||doc.location.href==s.iframeSrc){if(!timedOut)
return;}
io.detachEvent?io.detachEvent('onload',cb):io.removeEventListener('load',cb,false);var ok=true;try{if(timedOut){throw'timeout';}
var isXml=s.dataType=='xml'||doc.XMLDocument||$.isXMLDoc(doc);log('isXml='+isXml);if(!isXml&&window.opera&&(doc.body==null||doc.body.innerHTML=='')){if(--domCheckCount){log('requeing onLoad callback, DOM not available');setTimeout(cb,250);return;}}
xhr.responseText=doc.body?doc.body.innerHTML:doc.documentElement?doc.documentElement.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(!xhr.responseText&&xhr.responseXML&&!s.dataType)
s.dataType='xml';xhr.getResponseHeader=function(header){var headers={'content-type':s.dataType};return headers[header];};var scr=/(json|script|text)/.test(s.dataType);if(scr||s.textarea){var ta=doc.getElementsByTagName('textarea')[0];if(ta){xhr.responseText=ta.value;}
else if(scr){var pre=doc.getElementsByTagName('pre')[0];var b=doc.getElementsByTagName('body')[0];if(pre){xhr.responseText=pre.textContent;}
else if(b){xhr.responseText=b.innerHTML;}}}
else if(s.dataType=='xml'&&!xhr.responseXML&&xhr.responseText!=null){xhr.responseXML=toXml(xhr.responseText);}
data=httpData(xhr,s.dataType,s);}
catch(e){log('error caught:',e);ok=false;xhr.error=e;s.error&&s.error.call(s.context,xhr,'error',e);g&&$.event.trigger("ajaxError",[xhr,s,e]);}
if(xhr.aborted){log('upload aborted');ok=false;}
if(ok){s.success&&s.success.call(s.context,data,'success',xhr);g&&$.event.trigger("ajaxSuccess",[xhr,s]);}
g&&$.event.trigger("ajaxComplete",[xhr,s]);if(g&&!--$.active){$.event.trigger("ajaxStop");}
s.complete&&s.complete.call(s.context,xhr,ok?'success':'error');callbackProcessed=true;if(s.timeout)
clearTimeout(timeoutHandle);setTimeout(function(){$io.removeData('form-plugin-onload');$io.remove();xhr.responseXML=null;},100);}
var toXml=$.parseXML||function(s,doc){if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');doc.async='false';doc.loadXML(s);}
else{doc=(new DOMParser()).parseFromString(s,'text/xml');}
return(doc&&doc.documentElement&&doc.documentElement.nodeName!='parsererror')?doc:null;};var parseJSON=$.parseJSON||function(s){return window['eval']('('+s+')');};var httpData=function(xhr,type,s){var ct=xhr.getResponseHeader('content-type')||'',xml=type==='xml'||!type&&ct.indexOf('xml')>=0,data=xml?xhr.responseXML:xhr.responseText;if(xml&&data.documentElement.nodeName==='parsererror'){$.error&&$.error('parsererror');}
if(s&&s.dataFilter){data=s.dataFilter(data,type);}
if(typeof data==='string'){if(type==='json'||!type&&ct.indexOf('json')>=0){data=parseJSON(data);}else if(type==="script"||!type&&ct.indexOf("javascript")>=0){$.globalEval(data);}}
return data;};}};$.fn.ajaxForm=function(options){if(this.length===0){var o={s:this.selector,c:this.context};if(!$.isReady&&o.s){log('DOM not ready, queuing ajaxForm');$(function(){$(o.s,o.c).ajaxForm(options);});return this;}
log('terminating; zero elements found by selector'+($.isReady?'':' (DOM not ready)'));return this;}
return this.ajaxFormUnbind().bind('submit.form-plugin',function(e){if(!e.isDefaultPrevented()){e.preventDefault();$(this).ajaxSubmit(options);}}).bind('click.form-plugin',function(e){var target=e.target;var $el=$(target);if(!($el.is(":submit,input:image"))){var t=$el.closest(':submit');if(t.length==0){return;}
target=t[0];}
var form=this;form.clk=target;if(target.type=='image'){if(e.offsetX!=undefined){form.clk_x=e.offsetX;form.clk_y=e.offsetY;}else if(typeof $.fn.offset=='function'){var offset=$el.offset();form.clk_x=e.pageX-offset.left;form.clk_y=e.pageY-offset.top;}else{form.clk_x=e.pageX-target.offsetLeft;form.clk_y=e.pageY-target.offsetTop;}}
setTimeout(function(){form.clk=form.clk_x=form.clk_y=null;},100);});};$.fn.ajaxFormUnbind=function(){return this.unbind('submit.form-plugin click.form-plugin');};$.fn.formToArray=function(semantic){var a=[];if(this.length===0){return a;}
var form=this[0];var els=semantic?form.getElementsByTagName('*'):form.elements;if(!els){return a;}
var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++){el=els[i];n=el.name;if(!n){continue;}
if(semantic&&form.clk&&el.type=="image"){if(!el.disabled&&form.clk==el){a.push({name:n,value:$(el).val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}
continue;}
v=$.fieldValue(el,true);if(v&&v.constructor==Array){for(j=0,jmax=v.length;j<jmax;j++){a.push({name:n,value:v[j]});}}
else if(v!==null&&typeof v!='undefined'){a.push({name:n,value:v});}}
if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name;if(n&&!input.disabled&&input.type=='image'){a.push({name:n,value:$input.val()});a.push({name:n+'.x',value:form.clk_x},{name:n+'.y',value:form.clk_y});}}
return a;};$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic));};$.fn.fieldSerialize=function(successful){var a=[];this.each(function(){var n=this.name;if(!n){return;}
var v=$.fieldValue(this,successful);if(v&&v.constructor==Array){for(var i=0,max=v.length;i<max;i++){a.push({name:n,value:v[i]});}}
else if(v!==null&&typeof v!='undefined'){a.push({name:this.name,value:v});}});return $.param(a);};$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i];var v=$.fieldValue(el,successful);if(v===null||typeof v=='undefined'||(v.constructor==Array&&!v.length)){continue;}
v.constructor==Array?$.merge(val,v):val.push(v);}
return val;};$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(successful===undefined){successful=true;}
if(successful&&(!n||el.disabled||t=='reset'||t=='button'||(t=='checkbox'||t=='radio')&&!el.checked||(t=='submit'||t=='image')&&el.form&&el.form.clk!=el||tag=='select'&&el.selectedIndex==-1)){return null;}
if(tag=='select'){var index=el.selectedIndex;if(index<0){return null;}
var a=[],ops=el.options;var one=(t=='select-one');var max=(one?index+1:ops.length);for(var i=(one?index:0);i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(!v){v=(op.attributes&&op.attributes['value']&&!(op.attributes['value'].specified))?op.text:op.value;}
if(one){return v;}
a.push(v);}}
return a;}
return $(el).val();};$.fn.clearForm=function(){return this.each(function(){$('input,select,textarea',this).clearFields();});};$.fn.clearFields=$.fn.clearInputs=function(){return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();if(t=='text'||t=='password'||tag=='textarea'){this.value='';}
else if(t=='checkbox'||t=='radio'){this.checked=false;}
else if(tag=='select'){this.selectedIndex=-1;}});};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=='function'||(typeof this.reset=='object'&&!this.reset.nodeType)){this.reset();}});};$.fn.enable=function(b){if(b===undefined){b=true;}
return this.each(function(){this.disabled=!b;});};$.fn.selected=function(select){if(select===undefined){select=true;}
return this.each(function(){var t=this.type;if(t=='checkbox'||t=='radio'){this.checked=select;}
else if(this.tagName.toLowerCase()=='option'){var $sel=$(this).parent('select');if(select&&$sel[0]&&$sel[0].type=='select-one'){$sel.find('option').selected(false);}
this.selected=select;}});};function log(){if($.fn.ajaxSubmit.debug){var msg='[jquery.form] '+Array.prototype.join.call(arguments,'');if(window.console&&window.console.log){window.console.log(msg);}
else if(window.opera&&window.opera.postError){window.opera.postError(msg);}}};})(jQuery);(function($){$.jGrowl=function(m,o){if($('#jGrowl').size()==0)
$('<div id="jGrowl"></div>').addClass((o&&o.position)?o.position:$.jGrowl.defaults.position).appendTo('body');$('#jGrowl').jGrowl(m,o);};$.fn.jGrowl=function(m,o){if($.isFunction(this.each)){var args=arguments;return this.each(function(){var self=this;if($(this).data('jGrowl.instance')==undefined){$(this).data('jGrowl.instance',$.extend(new $.fn.jGrowl(),{notifications:[],element:null,interval:null}));$(this).data('jGrowl.instance').startup(this);}
if($.isFunction($(this).data('jGrowl.instance')[m])){$(this).data('jGrowl.instance')[m].apply($(this).data('jGrowl.instance'),$.makeArray(args).slice(1));}else{$(this).data('jGrowl.instance').create(m,o);}});};};$.extend($.fn.jGrowl.prototype,{defaults:{pool:0,header:'',group:'',sticky:false,position:'top-right',glue:'after',theme:'default',themeState:'highlight',corners:'10px',check:250,life:3000,closeDuration:'normal',openDuration:'normal',easing:'swing',closer:true,closeTemplate:'&times;',closerTemplate:'<div>[ close all ]</div>',log:function(e,m,o){},beforeOpen:function(e,m,o){},afterOpen:function(e,m,o){},open:function(e,m,o){},beforeClose:function(e,m,o){},close:function(e,m,o){},animateOpen:{opacity:'show'},animateClose:{opacity:'hide'}},notifications:[],element:null,interval:null,create:function(message,o){var o=$.extend({},this.defaults,o);if(typeof o.speed!=='undefined'){o.openDuration=o.speed;o.closeDuration=o.speed;}
this.notifications.push({message:message,options:o});o.log.apply(this.element,[this.element,message,o]);},render:function(notification){var self=this;var message=notification.message;var o=notification.options;var notification=$('<div class="jGrowl-notification '+o.themeState+' ui-corner-all'+
((o.group!=undefined&&o.group!='')?' '+o.group:'')+'">'+'<div class="jGrowl-close">'+o.closeTemplate+'</div>'+'<div class="jGrowl-header">'+o.header+'</div>'+'<div class="jGrowl-message">'+message+'</div></div>').data("jGrowl",o).addClass(o.theme).children('div.jGrowl-close').bind("click.jGrowl",function(){$(this).parent().trigger('jGrowl.close');}).parent();$(notification).bind("mouseover.jGrowl",function(){$('div.jGrowl-notification',self.element).data("jGrowl.pause",true);}).bind("mouseout.jGrowl",function(){$('div.jGrowl-notification',self.element).data("jGrowl.pause",false);}).bind('jGrowl.beforeOpen',function(){if(o.beforeOpen.apply(notification,[notification,message,o,self.element])!=false){$(this).trigger('jGrowl.open');}}).bind('jGrowl.open',function(){if(o.open.apply(notification,[notification,message,o,self.element])!=false){if(o.glue=='after'){$('div.jGrowl-notification:last',self.element).after(notification);}else{$('div.jGrowl-notification:first',self.element).before(notification);}
$(this).animate(o.animateOpen,o.openDuration,o.easing,function(){if($.browser.msie&&(parseInt($(this).css('opacity'),10)===1||parseInt($(this).css('opacity'),10)===0))
this.style.removeAttribute('filter');$(this).data("jGrowl").created=new Date();$(this).trigger('jGrowl.afterOpen');});}}).bind('jGrowl.afterOpen',function(){o.afterOpen.apply(notification,[notification,message,o,self.element]);}).bind('jGrowl.beforeClose',function(){if(o.beforeClose.apply(notification,[notification,message,o,self.element])!=false)
$(this).trigger('jGrowl.close');}).bind('jGrowl.close',function(){$(this).data('jGrowl.pause',true);$(this).animate(o.animateClose,o.closeDuration,o.easing,function(){$(this).remove();var close=o.close.apply(notification,[notification,message,o,self.element]);if($.isFunction(close))
close.apply(notification,[notification,message,o,self.element]);});}).trigger('jGrowl.beforeOpen');if(o.corners!=''&&$.fn.corner!=undefined)$(notification).corner(o.corners);if($('div.jGrowl-notification:parent',self.element).size()>1&&$('div.jGrowl-closer',self.element).size()==0&&this.defaults.closer!=false){$(this.defaults.closerTemplate).addClass('jGrowl-closer ui-state-highlight ui-corner-all').addClass(this.defaults.theme).appendTo(self.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){$(this).siblings().trigger("jGrowl.beforeClose");if($.isFunction(self.defaults.closer)){self.defaults.closer.apply($(this).parent()[0],[$(this).parent()[0]]);}});};},update:function(){$(this.element).find('div.jGrowl-notification:parent').each(function(){if($(this).data("jGrowl")!=undefined&&$(this).data("jGrowl").created!=undefined&&($(this).data("jGrowl").created.getTime()+parseInt($(this).data("jGrowl").life))<(new Date()).getTime()&&$(this).data("jGrowl").sticky!=true&&($(this).data("jGrowl.pause")==undefined||$(this).data("jGrowl.pause")!=true)){$(this).trigger('jGrowl.beforeClose');}});if(this.notifications.length>0&&(this.defaults.pool==0||$(this.element).find('div.jGrowl-notification:parent').size()<this.defaults.pool))
this.render(this.notifications.shift());if($(this.element).find('div.jGrowl-notification:parent').size()<2){$(this.element).find('div.jGrowl-closer').animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){$(this).remove();});}},startup:function(e){this.element=$(e).addClass('jGrowl').append('<div class="jGrowl-notification"></div>');this.interval=setInterval(function(){$(e).data('jGrowl.instance').update();},parseInt(this.defaults.check));if($.browser.msie&&parseInt($.browser.version)<7&&!window["XMLHttpRequest"]){$(this.element).addClass('ie6');}},shutdown:function(){$(this.element).removeClass('jGrowl').find('div.jGrowl-notification').remove();clearInterval(this.interval);},close:function(){$(this.element).find('div.jGrowl-notification').each(function(){$(this).trigger('jGrowl.beforeClose');});}});$.jGrowl.defaults=$.fn.jGrowl.prototype.defaults;})(jQuery);(function($){var elem_tip_map={};var showing=null;function noop(){}
var defaults={activation:"hover",keepAlive:false,maxWidth:"200px",edgeOffset:3,defaultPosition:"bottom",delay:400,fadeIn:200,fadeOut:200,attribute:"title",content:false,controlled:false,enter:function(){},exit:function(){}};function Tip(opts,org_elem){var self=this;opts=$.extend({},defaults,opts);this.opts=opts;this.org_elem=org_elem;if(opts.content){this.org_title=opts.content;}else{this.org_title=org_elem.attr(opts.attribute);}
if(this.org_title!=""){if(!opts.content){org_elem.removeAttr(opts.attribute);}
this.timeout=false;if(!this.opts.controlled){this.setActivation(opts.activation);}
this.holder=$('<div class="tiptip_holder" style="max-width:'+this.opts.maxWidth+';"></div>');this.content=$('<div class="tiptip_content"></div>');this.arrow=$('<div class="tiptip_arrow"></div>').html('<div class="tiptip_arrow_inner"></div>');$("body").append(this.holder.html(this.content).prepend(this.arrow));}}
Tip.prototype.setActivation=function(type){var self=this;function activate(){self.active();return false;}
function deactivate(){self.deactive();}
function deactivateIfNotKeepAlive(){if(!self.opts.keepAlive){self.deactive();}}
this.activated_type=type;if(type=="hover"){this.org_elem.hover(activate,deactivateIfNotKeepAlive);if(this.opts.keepAlive){this.holder.hover(noop,deactivate);}}else if(type=="focus"){this.org_elem.focus(activate).blur(deactivate);}else if(type=="click"){this.org_elem.click(activate).hover(noop,deactivateIfNotKeepAlive);if(this.opts.keepAlive){this.holder.hover(noop,deactivate);}}else{}};Tip.prototype.active=function(){if(showing&&!this.opts.controlled){return;}
if(!this.opts.controlled){showing=this;}
this.opts.enter.call(this.org_elem);this.content.html(this.org_title);var match=/\s+tip_\w+/.exec(this.holder.attr('class'));this.holder.hide().removeClass(match).css("margin","0");this.arrow.removeAttr("style");var top=parseInt(this.org_elem.offset()['top']);var left=parseInt(this.org_elem.offset()['left']);var org_width=parseInt(this.org_elem.outerWidth());var org_height=parseInt(this.org_elem.outerHeight());var tip_w=this.holder.outerWidth();var tip_h=this.holder.outerHeight();var w_compare=Math.round((org_width-tip_w)/2);var h_compare=Math.round((org_height-tip_h)/2);var marg_left=Math.round(left+w_compare);var marg_top=Math.round(top+org_height+this.opts.edgeOffset);var t_class="";var arrow_top="";var arrow_left=Math.round(tip_w-12)/2;if(this.opts.defaultPosition=="bottom"){t_class="_bottom";}else if(this.opts.defaultPosition=="top"){t_class="_top";}else if(this.opts.defaultPosition=="left"){t_class="_left";}else if(this.opts.defaultPosition=="right"){t_class="_right";}
var right_compare=(w_compare+left)<parseInt($(window).scrollLeft());var left_compare=(tip_w+left)>parseInt($(window).width());if((right_compare&&w_compare<0)||(t_class=="_right"&&!left_compare)||(t_class=="_left"&&left<(tip_w+this.opts.edgeOffset+5))){t_class="_right";arrow_top=Math.round(tip_h-13)/2;arrow_left=-12;marg_left=Math.round(left+org_width+this.opts.edgeOffset);marg_top=Math.round(top+h_compare);}else if((left_compare&&w_compare<0)||(t_class=="_left"&&!right_compare)){t_class="_left";arrow_top=Math.round(tip_h-13)/2;arrow_left=Math.round(tip_w);marg_left=Math.round(left-(tip_w+this.opts.edgeOffset+5));marg_top=Math.round(top+h_compare);}
var top_compare=(top+org_height+this.opts.edgeOffset+tip_h+8)>parseInt($(window).height()+$(window).scrollTop());var bottom_compare=((top+org_height)-(this.opts.edgeOffset+tip_h+8))<0;if(top_compare||(t_class=="_bottom"&&top_compare)||(t_class=="_top"&&!bottom_compare)){if(t_class=="_top"||t_class=="_bottom"){t_class="_top";}else{t_class=t_class+"_top";}
arrow_top=tip_h;marg_top=Math.round(top-(tip_h+5+this.opts.edgeOffset));}else if(bottom_compare|(t_class=="_top"&&bottom_compare)||(t_class=="_bottom"&&!top_compare)){if(t_class=="_top"||t_class=="_bottom"){t_class="_bottom";}else{t_class=t_class+"_bottom";}
arrow_top=-12;marg_top=Math.round(top+org_height+this.opts.edgeOffset);}
if(t_class=="_right_top"||t_class=="_left_top"){marg_top=marg_top+5;}else if(t_class=="_right_bottom"||t_class=="_left_bottom"){marg_top=marg_top-5;}
if(t_class=="_left_top"||t_class=="_left_bottom"){marg_left=marg_left+5;}
this.arrow.css({"margin-left":arrow_left+"px","margin-top":arrow_top+"px"});this.holder.css({"margin-left":marg_left+"px","margin-top":marg_top+"px"}).addClass("tip"+t_class);if(this.timeout){clearTimeout(this.timeout);}
var self=this;this.timeout=setTimeout(function(){self.holder.stop(true,true).fadeIn(self.opts.fadeIn);},this.opts.delay);};Tip.prototype.deactive=function(){this.opts.exit.call(this.org_elem);if(this.timeout){clearTimeout(this.timeout);}
this.holder.fadeOut(this.opts.fadeOut);if(!this.opts.controlled&&showing===this){showing=null;}};$.fn.tipTipTip=function(options){return this.each(function(){var tip=$(this).data('tip');if(typeof options=='string'){if(!tip){return;}
if(options=='on'){tip.active();}else if(options=='off'){tip.deactive();}}else{if(!tip){$(this).data('tip',new Tip(options,$(this)));}}});}})(jQuery);(function($){var popupsblocked=false;var blockingdialog_lock=false;var autopopid_next=0;function autopopid(){autopopid_next+=1;return autopopid_next;}
function joinOpts(opts){var a=[];for(var k in opts){a.push(k+'='+opts[k]);}
return a.join(',');}
function getWindowNWSE(win){if(!win){win=window;}
var top=win.screenY||win.screenTop;var left=win.screenX||win.screenLeft;return{x0:top,y0:left,x1:left+$(win).width(),y1:top+$(win).height()};}
$.fn.autoPopDialog=function(opts){if(!opts){opts={};}
var popout_callback=function(){};var popin_callback=function(){};if(opts.popout_callback){popout_callback=opts.popout_callback;delete opts.popout_callback;}
if(opts.popin_callback){popin_callback=opts.popin_callback;delete opts.popin_callback;}
opts.dragStart=function(event,ui){watchingDrag=true;};opts.drag=function(event,ui){if(!watchingDrag){return;}
if(lastOffset!=null){if(lastOffset.left==ui.offset.left&&lastOffset.top==ui.offset.top){var widget=dialog.dialog('widget');var maxX=$(window).width()-widget.width();var maxY=$(window).height()-widget.height();var direction='';if(lastOffset.left<=0){direction='left';}else if(lastOffset.top<=0){direction='up';}else if(lastOffset.left>=maxX){direction='right';}else if(lastOffset.top>=maxY){direction='down';}
popOut(direction,event);}}
lastOffset=ui.offset;};opts.dragStop=function(event,ui){watchingDrag=false;};var dialog=this.dialog(opts);var watchingDrag=false;var lastOffset=null;var popped=false;var poppedchildren=null;var popcorn=null;var popcornid='autopop_'+autopopid();function startCheckingForPopin(){function pointInside(pts,x,y){return pts.x0<=x&&x<=pts.x1&&pts.y0<=y&&y<=pts.y1;}
(function(){if(!popcorn||!popped){return;}
var winpts=getWindowNWSE();var poppts=getWindowNWSE(popcorn);var popX=poppts.x0;var popY=poppts.y0;var popXX=poppts.x1;var popYY=poppts.y1;var nwin=pointInside(winpts,popX,popY);var nein=pointInside(winpts,popXX,popY);var sein=pointInside(winpts,popXX,popYY);var swin=pointInside(winpts,popX,popYY);if(nwin&&nein&&sein&&swin){popIn(popX-winpts.x0,popY-winpts.y0);}
setTimeout(arguments.callee,100);})();}
function popOut(direction,event){if(popped){return;}
popped=true;var winpts=getWindowNWSE();var widget=dialog.dialog('widget').position();var x=event.screenX;var y=event.screenY;if(direction=='left'){x=winpts.x0;}else if(direction=='up'){}else if(direction=='right'){}else if(direction=='down'){x=winpts.x0+widget.left;}
popcorn=window.open('',popcornid,joinOpts({toolbar:0,location:0,width:dialog.width(),height:dialog.height(),top:y,left:x}));if(!popcorn){return;}
setTimeout(function(){if(popcorn.innerHeight==0){popupsblocked=true;popIn(null,null,true);if(!blockingdialog_lock){blockingdialog_lock=true;$("<div><p>The table was prevented from popping into a separate window.</p>"+"<p>It's likely that popups are being blocked.</p></div>").dialog({modal:true,title:"I wish I could do that for you!",buttons:{"Ok":function(){$(this).dialog('close');blockingdialog_lock=false;}}});}}else{startCheckingForPopin();}},500);dialog.dialog('widget').hide();var doc=popcorn.document;$(doc).ready(function(){doc.write();doc.close();popcorn.onunload=popIn;doc.title=dialog.dialog('option','title');var loc=window.location;var dochead=$('head',doc);dochead.append($('<base href="'+loc.protocol+'//'+loc.host+'" />',doc)).append($('<link rel="icon" type="image/x-icon" href="favicon.ico" />',doc));$('link').each(function(){if(this.rel=='stylesheet'){$(['<link href="',this.href,'" rel="stylesheet" type="text/css" ','media="screen" />'].join(''),doc).appendTo(dochead);}});var docbody=$('body',doc);poppedchildren=dialog.children().detach().appendTo(docbody);popout_callback.call(docbody);});}
function popIn(x,y,show){if(!popped){return;}
popped=false;var unpopable=null;if(popcorn&&popcorn.document&&popcorn.document.body){unpopable=$(popcorn.document.body).children();}else{unpopable=poppedchildren;}
unpopable.detach().appendTo(dialog);dialog.dialog('widget').show();if(typeof x=="number"&&typeof y=="number"){dialog.dialog('option','position',[y,x]);}else{if(!show){dialog.dialog('close');}}
if(!popcorn.closed){popcorn.close();}
popin_callback.call();}};})(jQuery);(function($){var ColorPicker=function(){var
ids={},inAction,charMin=65,visible,tpl='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',defaults={eventName:'click',onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:'ff0000',livePreview:true,flat:false},fillRGBFields=function(hsb,cal){var rgb=HSBToRGB(hsb);$(cal).data('colorpicker').fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end();},fillHSBFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end();},fillHexFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(0).val(HSBToHex(hsb)).end();},setSelector=function(hsb,cal){$(cal).data('colorpicker').selector.css('backgroundColor','#'+HSBToHex({h:hsb.h,s:100,b:100}));$(cal).data('colorpicker').selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)});},setHue=function(hsb,cal){$(cal).data('colorpicker').hue.css('top',parseInt(150-150*hsb.h/360,10));},setCurrentColor=function(hsb,cal){$(cal).data('colorpicker').currentColor.css('backgroundColor','#'+HSBToHex(hsb));},setNewColor=function(hsb,cal){$(cal).data('colorpicker').newColor.css('backgroundColor','#'+HSBToHex(hsb));},keyDown=function(ev){var pressedKey=ev.charCode||ev.keyCode||-1;if((pressedKey>charMin&&pressedKey<=90)||pressedKey==32){return false;}
var cal=$(this).parent().parent();if(cal.data('colorpicker').livePreview===true){change.apply(this);}},change=function(ev){var cal=$(this).parent().parent(),col;if(this.parentNode.className.indexOf('_hex')>0){cal.data('colorpicker').color=col=HexToHSB(fixHex(this.value));}else if(this.parentNode.className.indexOf('_hsb')>0){cal.data('colorpicker').color=col=fixHSB({h:parseInt(cal.data('colorpicker').fields.eq(4).val(),10),s:parseInt(cal.data('colorpicker').fields.eq(5).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(6).val(),10)});}else{cal.data('colorpicker').color=col=RGBToHSB(fixRGB({r:parseInt(cal.data('colorpicker').fields.eq(1).val(),10),g:parseInt(cal.data('colorpicker').fields.eq(2).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(3).val(),10)}));}
if(ev){fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));}
setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));cal.data('colorpicker').onChange.apply(cal,[col,HSBToHex(col),HSBToRGB(col)]);},blur=function(ev){var cal=$(this).parent().parent();cal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');},focus=function(){charMin=this.parentNode.className.indexOf('_hex')>0?70:65;$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');$(this).parent().addClass('colorpicker_focus');},downIncrement=function(ev){var field=$(this).parent().find('input').focus();var current={el:$(this).parent().addClass('colorpicker_slider'),max:this.parentNode.className.indexOf('_hsb_h')>0?360:(this.parentNode.className.indexOf('_hsb')>0?100:255),y:ev.pageY,field:field,val:parseInt(field.val(),10),preview:$(this).parent().parent().data('colorpicker').livePreview};$(document).bind('mouseup',current,upIncrement);$(document).bind('mousemove',current,moveIncrement);},moveIncrement=function(ev){ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10))));if(ev.data.preview){change.apply(ev.data.field.get(0),[true]);}
return false;},upIncrement=function(ev){change.apply(ev.data.field.get(0),[true]);ev.data.el.removeClass('colorpicker_slider').find('input').focus();$(document).unbind('mouseup',upIncrement);$(document).unbind('mousemove',moveIncrement);return false;},downHue=function(ev){var current={cal:$(this).parent(),y:$(this).offset().top};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upHue);$(document).bind('mousemove',current,moveHue);},moveHue=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.y))))/150,10)).get(0),[ev.data.preview]);return false;},upHue=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upHue);$(document).unbind('mousemove',moveHue);return false;},downSelector=function(ev){var current={cal:$(this).parent(),pos:$(this).offset()};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upSelector);$(document).bind('mousemove',current,moveSelector);},moveSelector=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX-ev.data.pos.left))))/150,10)).get(0),[ev.data.preview]);return false;},upSelector=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upSelector);$(document).unbind('mousemove',moveSelector);return false;},enterSubmit=function(ev){$(this).addClass('colorpicker_focus');},leaveSubmit=function(ev){$(this).removeClass('colorpicker_focus');},clickSubmit=function(ev){var cal=$(this).parent();var col=cal.data('colorpicker').color;cal.data('colorpicker').origColor=col;setCurrentColor(col,cal.get(0));cal.data('colorpicker').onSubmit(col,HSBToHex(col),HSBToRGB(col),cal.data('colorpicker').el);},show=function(ev){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset();var viewPort=getViewport();var top=pos.top+this.offsetHeight;var left=pos.left;if(top+176>viewPort.t+viewPort.h){top-=this.offsetHeight+176;}
if(left+356>viewPort.l+viewPort.w){left-=356;}
cal.css({left:left+'px',top:top+'px'});if(cal.data('colorpicker').onShow.apply(this,[cal.get(0)])!=false){cal.show();}
$(document).bind('mousedown',{cal:cal},hide);return false;},hide=function(ev){if(!isChildOf(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))){if(ev.data.cal.data('colorpicker').onHide.apply(this,[ev.data.cal.get(0)])!=false){ev.data.cal.hide();}
$(document).unbind('mousedown',hide);}},isChildOf=function(parentEl,el,container){if(parentEl==el){return true;}
if(parentEl.contains){return parentEl.contains(el);}
if(parentEl.compareDocumentPosition){return!!(parentEl.compareDocumentPosition(el)&16);}
var prEl=el.parentNode;while(prEl&&prEl!=container){if(prEl==parentEl)
return true;prEl=prEl.parentNode;}
return false;},getViewport=function(){var m=document.compatMode=='CSS1Compat';return{l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)};},fixHSB=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))};},fixRGB=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))};},fixHex=function(hex){var len=6-hex.length;if(len>0){var o=[];for(var i=0;i<len;i++){o.push('0');}
o.push(hex);hex=o.join('');}
return hex;},HexToRGB=function(hex){var hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)};},HexToHSB=function(hex){return RGBToHSB(HexToRGB(hex));},RGBToHSB=function(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;if(max!=0){}
hsb.s=max!=0?255*delta/max:0;if(hsb.s!=0){if(rgb.r==max){hsb.h=(rgb.g-rgb.b)/delta;}else if(rgb.g==max){hsb.h=2+(rgb.b-rgb.r)/delta;}else{hsb.h=4+(rgb.r-rgb.g)/delta;}}else{hsb.h=-1;}
hsb.h*=60;if(hsb.h<0){hsb.h+=360;}
hsb.s*=100/255;hsb.b*=100/255;return hsb;},HSBToRGB=function(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s==0){rgb.r=rgb.g=rgb.b=v;}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h==360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}
else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}
else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}
else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}
else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}
else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}
else{rgb.r=0;rgb.g=0;rgb.b=0}}
return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};},RGBToHex=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length==1){hex[nr]='0'+val;}});return hex.join('');},HSBToHex=function(hsb){return RGBToHex(HSBToRGB(hsb));},restoreOriginal=function(){var cal=$(this).parent();var col=cal.data('colorpicker').origColor;cal.data('colorpicker').color=col;fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));};return{init:function(opt){opt=$.extend({},defaults,opt||{});if(typeof opt.color=='string'){opt.color=HexToHSB(opt.color);}else if(opt.color.r!=undefined&&opt.color.g!=undefined&&opt.color.b!=undefined){opt.color=RGBToHSB(opt.color);}else if(opt.color.h!=undefined&&opt.color.s!=undefined&&opt.color.b!=undefined){opt.color=fixHSB(opt.color);}else{return this;}
return this.each(function(){if(!$(this).data('colorpickerId')){var options=$.extend({},opt);options.origColor=opt.color;var id='collorpicker_'+parseInt(Math.random()*1000);$(this).data('colorpickerId',id);var cal=$(tpl).attr('id',id);if(options.flat){cal.appendTo(this).show();}else{cal.appendTo(document.body);}
options.fields=cal.find('input').bind('keyup',keyDown).bind('change',change).bind('blur',blur).bind('focus',focus);cal.find('span').bind('mousedown',downIncrement).end().find('>div.colorpicker_current_color').bind('click',restoreOriginal);options.selector=cal.find('div.colorpicker_color').bind('mousedown',downSelector);options.selectorIndic=options.selector.find('div div');options.el=this;options.hue=cal.find('div.colorpicker_hue div');cal.find('div.colorpicker_hue').bind('mousedown',downHue);options.newColor=cal.find('div.colorpicker_new_color');options.currentColor=cal.find('div.colorpicker_current_color');cal.data('colorpicker',options);cal.find('div.colorpicker_submit').bind('mouseenter',enterSubmit).bind('mouseleave',leaveSubmit).bind('click',clickSubmit);fillRGBFields(options.color,cal.get(0));fillHSBFields(options.color,cal.get(0));fillHexFields(options.color,cal.get(0));setHue(options.color,cal.get(0));setSelector(options.color,cal.get(0));setCurrentColor(options.color,cal.get(0));setNewColor(options.color,cal.get(0));if(options.flat){cal.css({position:'relative',display:'block'});}else{$(this).bind(options.eventName,show);}}});},showPicker:function(){return this.each(function(){if($(this).data('colorpickerId')){show.apply(this);}});},hidePicker:function(){return this.each(function(){if($(this).data('colorpickerId')){$('#'+$(this).data('colorpickerId')).hide();}});},setColor:function(col){if(typeof col=='string'){col=HexToHSB(col);}else if(col.r!=undefined&&col.g!=undefined&&col.b!=undefined){col=RGBToHSB(col);}else if(col.h!=undefined&&col.s!=undefined&&col.b!=undefined){col=fixHSB(col);}else{return this;}
return this.each(function(){if($(this).data('colorpickerId')){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').color=col;cal.data('colorpicker').origColor=col;fillRGBFields(col,cal.get(0));fillHSBFields(col,cal.get(0));fillHexFields(col,cal.get(0));setHue(col,cal.get(0));setSelector(col,cal.get(0));setCurrentColor(col,cal.get(0));setNewColor(col,cal.get(0));}});}};}();$.fn.extend({ColorPicker:ColorPicker.init,ColorPickerHide:ColorPicker.hidePicker,ColorPickerShow:ColorPicker.showPicker,ColorPickerSetColor:ColorPicker.setColor});})(jQuery)
var Graticule=(function(){function _(map,sexagesimal){this.sex_=sexagesimal||false;this.set('container',document.createElement('DIV'));this.show();this.setMap(map);}
_.prototype=new google.maps.OverlayView();_.prototype.addDiv=function(div){this.get('container').appendChild(div);},_.prototype.decToSex=function(d){var degs=Math.floor(d);var mins=((Math.abs(d)-degs)*60.0).toFixed(2);if(mins=="60.00"){degs+=1.0;mins="0.00";}
return[degs,":",mins].join('');};_.prototype.onAdd=function(){var self=this;this.getPanes().mapPane.appendChild(this.get('container'));function redraw(){self.draw();}
google.maps.event.addListener(this.getMap(),'idle',redraw);function changeColor(){var color=_bestTextColor(self);var s=self.get('container').style;s.color=color;s.backgroundColor=color;}
changeColor();google.maps.event.addListener(this.getMap(),'maptypeid_changed',changeColor);};_.prototype.clear=function(){var container=this.get('container');while(container.hasChildNodes()){container.removeChild(container.firstChild);}};_.prototype.onRemove=function(){this.getPanes().mapPane.removeChild(container);};_.prototype.show=function(){this.get('container').style.visibility='visible';};_.prototype.hide=function(){this.get('container').style.visibility='hidden';};function _bestTextColor(overlay){var type=overlay.getMap().getMapTypeId();var GMM=google.maps.MapTypeId;if(type===GMM.HYBRID)return'#fff';if(type===GMM.ROADMAP)return'#000';if(type===GMM.SATELLITE)return'#fff';if(type===GMM.TERRAIN)return'#000';return'#fff';};function gridPrecision(dDeg){if(dDeg<0.01)return 3;if(dDeg<0.1)return 2;if(dDeg<1)return 1;return 0;}
function leThenReturn(x,l,d){for(var i=0;i<l.length;i+=1){if(x<=l[i]){return l[i];}}
return d;}
var numLines=10;var decmins=[0.06,0.12,0.3,0.6,1.2,3,6,12,30,60,60*2,60*5,60*10,60*20,60*30,];var sexmins=[0.01,0.02,0.05,0.1,0.2,0.5,1.0,3,6,12,30,60,60*2,60*5,60*10,60*20,60*30,];function mins_list(overlay){if(overlay.sex_)return sexmins;return decmins;}
function latLngToPixel(overlay,lat,lng){return overlay.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(lat,lng));};function gridInterval(dDeg,mins){return leThenReturn(Math.ceil(dDeg/numLines*6000)/100,mins,60*45)/60;}
function npx(n){return n.toString()+'px';}
function makeLabel(x,y,text){var d=document.createElement('DIV');var s=d.style;s.position='absolute';s.left=npx(x);s.top=npx(y);s.color='inherit';s.width='3em';s.fontSize='0.6em';s.whiteSpace='nowrap';d.innerHTML=text;return d;};function createLine(x,y,w,h){var d=document.createElement('DIV');var s=d.style;s.position='absolute';s.overflow='hidden';s.backgroundColor='inherit';s.opacity=0.3;var s=d.style;s.left=npx(x);s.top=npx(y);s.width=npx(w);s.height=npx(h);return d;};var span=50000;function meridian(px){return createLine(px,-span,1,2*span);}
function parallel(py){return createLine(-span,py,2*span,1);}
function eqE(a,b,e){if(!e){e=Math.pow(10,-6);}
if(Math.abs(a-b)<e){return true;}
return false;}
_.prototype.draw=function(){this.clear();if(this.get('container').style.visibility!='visible'){return;}
var bnds=this.getMap().getBounds();if(!bnds){return;}
var sw=bnds.getSouthWest(),ne=bnds.getNorthEast();var l=sw.lng(),b=sw.lat(),r=ne.lng(),t=ne.lat();var mins=mins_list(this);var dLat=gridInterval(t-b,mins);var dLng=gridInterval(bnds.toSpan().lng(),mins);var pxr=latLngToPixel(this,0,r).x
var pxl=latLngToPixel(this,0,l).x;var div=this.getMap().getDiv();var width=null;if(div.currentStyle){width=div.currentStyle['width'];}else if(window.getComputedStyle){width=document.defaultView.getComputedStyle(div,null).getPropertyValue('width');}
width=Number(width.slice(0,-2));if(!eqE(Math.abs(pxr-pxl),width,Math.pow(10,-4))){l=-180;r=180;dLng=30;}else{l=Math.floor(l/dLng)*dLng;b=Math.floor(b/dLat)*dLat;t=Math.ceil(t/dLat)*dLat;r=Math.ceil(r/dLng)*dLng;if(r==l)l+=dLng;if(r<l)r+=360.0;}
var crosslng=l+2*dLng;var y=latLngToPixel(this,b+2*dLat,l).y+2;for(var lo=l;lo<r;lo+=dLng){if(lo>180.0){r-=360.0;lo-=360.0;}
var px=latLngToPixel(this,b,lo).x;this.addDiv(meridian(px));var atcross=eqE(lo,crosslng);this.addDiv(makeLabel(px+(atcross?17:3),y-(atcross?3:0),(this.sex_?this.decToSex(lo):lo.toFixed(gridPrecision(dLng)))));}
var crosslat=b+2*dLat;var x=latLngToPixel(this,b,l+2*dLng).x+3;for(;b<=t;b+=dLat){var py=latLngToPixel(this,b,l).y;this.addDiv(parallel(py));this.addDiv(makeLabel(x,py+(eqE(b,crosslat)?7:2),(this.sex_?this.decToSex(b):b.toFixed(gridPrecision(dLat)))));}};return _;})();var EarthMapType=(function(){function LOG(){if(console&&console.log){console.log(arguments);}else{alert(arguments);}}
function origin(){var uriparts=[window.location.protocol,'//',window.location.host];uriparts=uriparts.concat(arguments.length>0?arguments:[]);return uriparts.join('');}
function position(obj){if(!obj){return[0,0];}
var ppos=position(obj.offsetParent);return[obj.offsetLeft+ppos[0],obj.offsetTop+ppos[1]];}
function wrapFn(fn,extensionfn,opts){function wrapped(){if(opts&&opts.extendBefore){extensionfn.apply(this,arguments);}
fn.apply(this,arguments);if(!opts||!opts.extendBefore){extensionfn.apply(this,arguments);}};if(opts&&opts.prototype){wrapped.prototype=new fn();}
return wrapped;}
function makeIframeShim(){var shim=document.createElement('IFRAME');shim.src='javascript:false';shim.style.position='absolute';shim.style.border='none';return shim;}
var magicShimOffset=-7;function setIframeShim(shim,shimmed){var pos=position(shimmed);shim.style.visibility='visible';shim.style.width=shimmed.offsetWidth+'px';shim.style.height=shimmed.offsetHeight+'px';shim.style.left=pos[0]+magicShimOffset+'px';shim.style.top=pos[1]+magicShimOffset+'px';shimmed.parentNode.appendChild(shim);shimmed.style.zIndex=shim.style.zIndex+1;}
var Linker=(function(){function Linker(){this.map={};this.next_id=0;this.name='earthlink';this.id_name=['__',this.name,'_id'].join('');}
Linker.prototype.getId=function(obj){if(obj[this.id_name]===null||obj[this.id_name]==undefined){obj[this.id_name]=this.next_id;this.next_id+=1;}
return obj[this.id_name];};Linker.prototype.add=function(obj){var k=this.getId(obj);if(!this.map[k]){this.map[k]=obj;google.maps.event.trigger(this,'insert',obj);}};Linker.prototype.remove=function(obj){var k=this.getId(obj);if(this.map[k]){delete this.map[k];google.maps.event.trigger(this,'remove',obj);}};Linker.prototype.contains=function(obj){var k=this.getId(obj);if(this.map[k]){return true;}
return false;};Linker.prototype.forEach=function(fn){for(var i in this.map){this.map.hasOwnProperty(i)&&fn.call(this,this.map[i]);}};return Linker;})();function MapToEarth(earth){var self=this;this.bindTo('linker',earth);this.bindTo('earth_plugin',earth);this.rTzRatio=0.6;this.map_earth={};this.earth_map={};function linkMapChanges(){this._map&&this._map[self.get('linker').name].remove(this);(this._map=this.get('map'))&&this._map[self.get('linker').name].add(this);}
google.maps.MarkerImage=wrapFn(google.maps.MarkerImage,function(url,size,origin,anchor,scaledSize){this.url=url;this.origin=origin;},{prototype:true});google.maps.Marker.prototype.map_changed=wrapFn(google.maps.Marker.prototype.map_changed,linkMapChanges);google.maps.Polyline.prototype.map_changed=wrapFn(google.maps.Polyline.prototype.map_changed,linkMapChanges);google.maps.Polygon.prototype.map_changed=wrapFn(google.maps.Polygon.prototype.map_changed,linkMapChanges);google.maps.Circle.prototype.map_changed=wrapFn(google.maps.Circle.prototype.map_changed,linkMapChanges);google.maps.Rectangle.prototype.map_changed=wrapFn(google.maps.Rectangle.prototype.map_changed,linkMapChanges);google.maps.KmlLayer.prototype.map_changed=wrapFn(google.maps.KmlLayer.prototype.map_changed,linkMapChanges);function overlaysAlreadySetOnMap(map){function findMapLinker(map){var streetview=map.getStreetView();if(!streetview){return null;}
for(var x in map){for(var y in streetview){if(map[x]===streetview[y]){return map[x];}}}
return null;}
var linker=findMapLinker(map);if(linker){var map=null;for(var x in linker){if(typeof(linker[x])=='object'){map=linker[x];}}
var presentObjects=[];for(var x in map){if(!map[x].mapOnly){presentObjects.push(map[x]);}}
return presentObjects;}
return[];}
var pobjs=overlaysAlreadySetOnMap(earth.get('map'));for(var i=0;i<pobjs.length;i+=1){linkMapChanges.apply(pobjs[i]);}
function insert(x){self.insert(x);}
function remove(x){self.remove(x);}
this.get('linker').forEach(insert);google.maps.event.addListener(this.get('linker'),'insert',insert);google.maps.event.addListener(this.get('linker'),'remove',remove);}
function addMVCFollower(listeners,obj,eventName,callback){listeners.push(google.maps.event.addListener(obj,eventName,callback));callback();}
MapToEarth.prototype=new google.maps.MVCObject();MapToEarth.prototype.insert=function(x){var self=this;function doInsert(mapobj,placemark,listeners){if(!placemark){return;}
var ge=self.get('earth_plugin');ge.getFeatures().appendChild(placemark);self.map_earth[self.get('linker').getId(mapobj)]=[placemark,listeners];self.earth_map[placemark]=mapobj;}
if(x instanceof google.maps.Marker){this.createMarker(x,doInsert);}else if(x instanceof google.maps.Polyline){this.createPolyline(x,doInsert);}else if(x instanceof google.maps.Polygon){this.createPolygon(x,doInsert);}else if(x instanceof google.maps.KmlLayer){this.createKmlLayer(x,doInsert);}else if(x instanceof google.maps.Circle){this.createCircle(x,doInsert);}else if(x instanceof google.maps.Rectangle){this.createRectangle(x,doInsert);}else{LOG('unrecognized',x);}};MapToEarth.prototype.remove=function(x){var ge=this.get('earth_plugin');var k=this.get('linker').getId(x);var earthobj=this.map_earth[k];var placemark=earthobj[0];var listeners=earthobj[1];if(listeners){listeners.forEach(function(x){google.maps.event.removeListener(x);});}
ge.getFeatures().removeChild(placemark);this.map_earth[k]=null;this.earth_map[placemark]=null;};MapToEarth.prototype.rangeToZoom=function(range){return Math.round(26-(Math.log(range*this.rTzRatio)/Math.log(2)));}
MapToEarth.prototype.zoomToRange=function(zoom){return Math.pow(2,26-zoom)/this.rTzRatio;}
MapToEarth.prototype.hexColorAndAlphaToEarthColor=function(hex,alpha){if(hex&&hex[0]=='#'){hex=hex.slice(1);}
if(!hex||(hex.length!=6&&hex.length!=3)){hex='#ff000000';}
if(hex.length==3){hex=[hex[0],hex[0],hex[1],hex[1],hex[2],hex[2]].join('');}
var r=hex.slice(0,2);var g=hex.slice(2,4);var b=hex.slice(4,6);var a=Math.floor(parseInt('ff',16)*alpha).toString(16);if(a.length<2){a='0'+a;}
return['#',a,b,g,r].join('');};MapToEarth.prototype.makeCircleLinearRing=function(ge,centerLat,centerLng,radius){var ring=ge.createLinearRing('');var steps=25;var pi2=Math.PI*2;for(var i=0;i<steps;i++){var lat=centerLat+radius*Math.cos(i/steps*pi2);var lng=centerLng+radius*Math.sin(i/steps*pi2);ring.getCoordinates().pushLatLngAlt(lat,lng,0);}
return ring;}
MapToEarth.prototype.createMarker=function(marker,doInsert){var ge=this.get('earth_plugin');var listeners=new google.maps.MVCArray();var placemark=ge.createPlacemark('');var point=ge.createPoint('');addMVCFollower(listeners,marker,'position_changed',function(){var latlng=marker.getPosition();if(latlng){point.setLatLng(latlng.lat(),latlng.lng());placemark.setGeometry(point);}});function iconChanged(){if(marker.getIcon()){var url=marker.getIcon().url;var absurl=url;if(absurl[0]=='/'){absurl=origin()+absurl;}
var mapImg=new Image();mapImg.src=absurl;mapImg.onload=function(){var mapHeight=mapImg.height;var icoWidth=marker.getIcon().size.width,icoHeight=marker.getIcon().size.height;var iconStyle=ge.parseKml(['<Style>','<IconStyle>','<Icon>','</Icon>','</IconStyle>','</Style>'].join(''));var anchor=marker.getIcon().anchor;iconStyle.getIconStyle().getHotSpot().set(anchor.x,ge.UNITS_PIXELS,icoHeight-anchor.y,ge.UNITS_PIXELS);iconStyle.getIconStyle().getIcon().setHref(absurl);iconStyle.getIconStyle().setScale(Math.min(icoWidth,icoHeight)/32.0);placemark.setStyleSelector(iconStyle);};}else{var style=ge.createStyle('');var icon=ge.createIcon('');icon.setHref('http://maps.google.com/mapfiles/kml/paddle/red-circle.png');style.getIconStyle().getHotSpot().set(32,ge.UNITS_PIXELS,1,ge.UNITS_PIXELS);style.getIconStyle().setIcon(icon);style.getIconStyle().setScale(1);placemark.setStyleSelector(style);}}
addMVCFollower(listeners,marker,'icon_changed',iconChanged);addMVCFollower(listeners,marker,'title_changed',function(){var title=marker.getTitle();if(title){placemark.setName(title);}else{placemark.setName('');}});addMVCFollower(listeners,marker,'visible_changed',function(){if(marker.getVisible()===false){placemark.setVisibility(false);}else{placemark.setVisibility(true);}});doInsert(marker,placemark,listeners);};MapToEarth.prototype.makePathListener=function(placemark,latlngs,coordinates){var listeners=new google.maps.MVCArray();listeners.push(google.maps.event.addListener(latlngs,'insert_at',function(i){var x=latlngs.getAt(i);var l=coordinates.getLength();if(i<l/2){var head=[];for(var j=0;j<i;j+=1){head.push(coordinates.shift());}
coordinates.unshiftLatLngAlt(x.lat(),x.lng(),0);for(var j=0;j<head.length;j+=1){coordinates.unshift(head[j]);}}else{var tail=[];for(var j=i;j<l-1;j+=1){tail.push(coordinates.get(j));}
coordinates.pushLatLngAlt(x.lat(),x.lng(),0);for(var j=0;j<tail.length;j+=1){coordinates.push(tail[j]);}}}));listeners.push(google.maps.event.addListener(latlngs,'remove_at',function(i,x){var l=coordinates.getLength();if(i<l/2){var head=[];for(var j=0;j<i;j+=1){head.push(coordinates.shift());}
coordinates.shift();for(var j=0;j<head.length;j+=1){coordinates.unshift(head[j]);}}else{for(var j=i;j<l-2;j+=1){coordinates.set(j,coordinates.get(j+1));}
coordinates.pop();}}));listeners.push(google.maps.event.addListener(latlngs,'set_at',function(i,y){var x=latlngs.getAt(i);coordinates.setLatLngAlt(i,x.lat(),x.lng(),0);}));latlngs.forEach(function(x){coordinates.pushLatLngAlt(x.lat(),x.lng(),0);});return listeners;};MapToEarth.prototype.createPolyline=function(polyline,doInsert){var self=this;var ge=this.get('earth_plugin');var placemark=ge.createPlacemark('');var linestring=ge.createLineString('');var latlngs=polyline.getPath();var coordinates=linestring.getCoordinates();linestring.setTessellate(true);var listeners=this.makePathListener(placemark,latlngs,coordinates);placemark.setGeometry(linestring);var line_style=ge.createStyle('');placemark.setStyleSelector(line_style);addMVCFollower(listeners,polyline,'style_changed',function(){var pstyle=polyline.get('style')||{};line_style.getLineStyle().setWidth(pstyle.strokeWeight||2);line_style.getLineStyle().getColor().set(self.hexColorAndAlphaToEarthColor(pstyle.strokeColor||'000000',pstyle.strokeOpacity||1));});doInsert(polyline,placemark,listeners);};MapToEarth.prototype.createPolygon=function(polygon,doInsert){var self=this;var ge=this.get('earth_plugin');var placemark=ge.createPlacemark('');var poly=ge.createPolygon('');var outer=ge.createLinearRing('');poly.setOuterBoundary(outer);var latlngs=polygon.getPath();var coordinates=outer.getCoordinates();var listeners=this.makePathListener(placemark,latlngs,coordinates);placemark.setGeometry(poly);var poly_style=ge.createStyle('');placemark.setStyleSelector(poly_style);addMVCFollower(listeners,polygon,'style_changed',function(){var pstyle=polygon.get('style')||{};poly_style.getLineStyle().getColor().set(self.hexColorAndAlphaToEarthColor(pstyle.strokeColor||'000000',pstyle.strokeOpacity||1));poly_style.getPolyStyle().getColor().set(self.hexColorAndAlphaToEarthColor(pstyle.fillColor||'000000',pstyle.fillOpacity||0.5));});doInsert(polygon,placemark,listeners);};MapToEarth.prototype.createKmlLayer=function(kmllayer,doInsert){var ge=this.get('earth_plugin');if(!kmllayer.kmlobj){google.earth.fetchKml(ge,kmllayer.url,function(kmlobj){if(kmlobj){kmllayer.kmlobj=kmlobj;doInsert(kmllayer,kmllayer.kmlobj);}});}else{doInsert(kmllayer,kmllayer.kmlobj);}};MapToEarth.prototype.createCircle=function(circle,doInsert){var self=this;var ge=this.get('earth_plugin');var listeners=new google.maps.MVCArray();var polyc=ge.createPlacemark('');polyc.setGeometry(ge.createPolygon(''));function centerOrRadiusChanged(){var center=circle.getCenter();polyc.getGeometry().setOuterBoundary(self.makeCircleLinearRing(ge,center.lat(),center.lng(),circle.getRadius()/Math.pow(10,5)));}
addMVCFollower(listeners,circle,'center_changed',centerOrRadiusChanged);addMVCFollower(listeners,circle,'radius_changed',centerOrRadiusChanged);centerOrRadiusChanged();var style=ge.createStyle('');polyc.setStyleSelector(style);function styleChanged(){style.getLineStyle().getColor().set(self.hexColorAndAlphaToEarthColor(circle.get('strokeColor')||'000000',circle.get('strokeOpacity')||1));style.getLineStyle().setWidth(circle.get('strokeWeight')||2);style.getPolyStyle().getColor().set(self.hexColorAndAlphaToEarthColor(circle.get('fillColor')||'000000',circle.get('fillOpacity')||0.5));};addMVCFollower(listeners,circle,'fillcolor_changed',styleChanged);addMVCFollower(listeners,circle,'fillopacity_changed',styleChanged);addMVCFollower(listeners,circle,'strokecolor_changed',styleChanged);addMVCFollower(listeners,circle,'strokeopacity_changed',styleChanged);addMVCFollower(listeners,circle,'strokeweight_changed',styleChanged);doInsert(circle,polyc);};MapToEarth.prototype.createRectangle=function(rect,doInsert){var self=this;var ge=this.get('earth_plugin');var listeners=new google.maps.MVCArray();var polyr=ge.createPlacemark('');polyr.setGeometry(ge.createPolygon(''));var rectRing=ge.createLinearRing('');var coords=rectRing.getCoordinates();polyr.getGeometry().setOuterBoundary(rectRing);addMVCFollower(listeners,rect,'bounds_changed',function(){var bounds=rect.getBounds();if(!bounds){console.log(rect);return;}
var sw=bounds.getSouthWest();var ne=bounds.getNorthEast();coords.clear();coords.pushLatLngAlt(sw.lat(),sw.lng(),0);coords.pushLatLngAlt(ne.lat(),sw.lng(),0);coords.pushLatLngAlt(ne.lat(),ne.lng(),0);coords.pushLatLngAlt(sw.lat(),ne.lng(),0);coords.pushLatLngAlt(sw.lat(),sw.lng(),0);});var style=ge.createStyle('');polyr.setStyleSelector(style);function styleChanged(){style.getLineStyle().getColor().set(self.hexColorAndAlphaToEarthColor(rect.get('strokeColor')||'000000',rect.get('strokeOpacity')||1));style.getLineStyle().setWidth(rect.get('strokeWeight')||2);style.getPolyStyle().getColor().set(self.hexColorAndAlphaToEarthColor(rect.get('fillColor')||'000000',rect.get('fillOpacity')||0.5));};addMVCFollower(listeners,rect,'fillcolor_changed',styleChanged);addMVCFollower(listeners,rect,'fillopacity_changed',styleChanged);addMVCFollower(listeners,rect,'strokecolor_changed',styleChanged);addMVCFollower(listeners,rect,'strokeopacity_changed',styleChanged);addMVCFollower(listeners,rect,'strokeweight_changed',styleChanged);doInsert(rect,polyr);};function EarthMapType(map){this.setMap(map);}
EarthMapType.prototype=new google.maps.OverlayView();EarthMapType.prototype.tileSize=new google.maps.Size(10000,10000);EarthMapType.prototype.maxZoom=19;EarthMapType.prototype.name='Earth';EarthMapType.prototype.alt='Show 3D earth';EarthMapType.prototype.getTile=function(coord,zoom,ownerDocument){return ownerDocument.createElement('DIV');};EarthMapType.prototype._withEarth=function(fn){var retry=200,retryDelay=50,self=this;(function(){var earth=self.get('earth_plugin');if(!earth&&retry>0){retry-=1;return setTimeout(arguments.callee,retryDelay);}
if(retry<=0){LOG(['ERROR: No earth plugin object was found in a ','reasonable time frame.'].join(''));return;}
fn(earth);})();};EarthMapType.prototype._initEarth=function(ge){var self=this;this.set('earth_plugin',ge);this.mapper=new MapToEarth(this);ge.getWindow().setVisibility(true);this.get('container_earth').childNodes[0].style.zIndex=1001;this.get('container_earth').style.visibility='hidden';google.earth.addEventListener(ge.getWindow(),'mouseout',function(){ge.getWindow().blur();});google.maps.event.addListener(this,'atmosphere_changed',function(){if(self.get('atmosphere')){ge.getOptions().setAtmosphereVisibility(true);}else{ge.getOptions().setAtmosphereVisibility(false);}});google.maps.event.addListener(this,'graticules_changed',function(){if(self.get('graticules')){ge.getOptions().setGridVisibility(true);}else{ge.getOptions().setGridVisibility(false);}});var win=ge.getWindow();var mousedown=false;function kmlme_to_me(kme){return{latLng:new google.maps.LatLng(kme.getLatitude(),kme.getLongitude())};}
function passAlong(earthEvent,mapEvent){google.earth.addEventListener(win,earthEvent,function(kmlmouseevent){if(kmlmouseevent.getDidHitGlobe()){google.maps.event.trigger(map,mapEvent?mapEvent:earthEvent,kmlme_to_me(kmlmouseevent));}});}
passAlong('click');passAlong('dblclick','doubleclick');passAlong('mouseover');google.earth.addEventListener(win,'mousedown',function(kmlmouseevent){mousedown=true;if(kmlmouseevent.getDidHitGlobe()){google.maps.event.trigger(map,'mousedown',kmlme_to_me(kmlmouseevent));}});google.earth.addEventListener(win,'mouseup',function(kmlmouseevent){mousedown=false;google.maps.event.trigger(map,'mouseup',kmlme_to_me(kmlmouseevent));});passAlong('mouseout');google.earth.addEventListener(win,'mousemove',function(kmlmouseevent){if(kmlmouseevent.getDidHitGlobe()){google.maps.event.trigger(map,'mousemove',kmlme_to_me(kmlmouseevent));if(mousedown){google.maps.event.trigger(map,'drag');}}});this.jumpToCenter(ge);google.maps.event.trigger(this,'initialized',true);};EarthMapType.prototype.getDiv=function(){var map=this._map||this.get('map');return map.getDiv().childNodes[0];};EarthMapType.prototype.onAdd=function(){var self=this;var map=this.getMap();this._map=map;this.set('linker',new Linker());map.mapTypes.set(this.name,this);map[this.get('linker').name]=this.get('linker');this[this.get('linker').name]=this.get('linker');this.set('maptypeid_listener',google.maps.event.addListener(map,'maptypeid_changed',function(){if(map.getMapTypeId()==self.name){self.show();}else{self.set('previousMapTypeId',map.getMapTypeId());self.get('showing')&&self.hide();}}));if(window.Graticule){this.set('overlay_graticules',new Graticule(map));this.get('overlay_graticules').hide();}
var earthDiv=document.createElement('DIV');earthDiv.id='CONTAINER_EARTH';earthDiv.style.width="100%";earthDiv.style.height="100%";earthDiv.style.visibility="hidden";this.getDiv().appendChild(earthDiv);this.set('container_earth',earthDiv);var shim=makeIframeShim();shim.style.zIndex=1000;this.set('shim',shim);google.maps.event.addListener(this,'graticules_changed',function(){if(self.get('graticules')){if(self.get('overlay_graticules')){self.get('overlay_graticules').show();self.get('overlay_graticules').draw();}}else{if(self.get('overlay_graticules')){self.get('overlay_graticules').hide();}}});if(google.earth){google.earth.createInstance(earthDiv,function(ge){try{self._initEarth(ge);}catch(e){LOG("Unable to initEarth");google.maps.event.trigger(self,'initialized',false);throw e;}},function(errorCode){LOG('Unable to initialize Google Earth plugin:',errorCode);google.maps.event.trigger(self,'initialized',false);});}else{LOG('Why did you include this library?');}};EarthMapType.prototype.onRemove=function(){this._map.mapTypes.set(this.name,null);google.maps.event.removeListener(this.get('maptypeid_listener'));this.getDiv().removeChild(this.get('container_earth'));this._map=null;this.get('shim').parentNode.removeChild(this.get('shim'));};EarthMapType.prototype.draw=function(){};EarthMapType.prototype._flyToAtSpeed=function(ge,lookat,speed){var flyToSpeed=ge.getOptions().getFlyToSpeed();ge.getOptions().setFlyToSpeed(speed?speed:ge.SPEED_TELEPORT);ge.getView().setAbstractView(lookat);ge.getOptions().setFlyToSpeed(flyToSpeed);};EarthMapType.prototype.show=function(){var ge=this.get('earth_plugin');var map=this.get('map');if(!ge){this.get('container_earth').style.visibility='inherit';this.set('showing',true);return;}
var shim=this.get('shim');var possible=this.get('map').getDiv().firstChild.children;var shimmed=null;for(var i=0;i<possible.length;i+=1){var e=possible[i];if(e.className.indexOf('gmnoprint')>-1){var children=e.children;var found=false;for(var j=0;j<children.length;j+=1){if(children[j].title.indexOf('Change map style')>-1){found=true;break;}}
if(found){shimmed=e;break;}}}
LOG('Shimmed',shimmed);if(shimmed){shimmed.onmousedown=function(){setIframeShim(shim,shimmed);};shimmed.onmousemove=function(){var menu_timeout=1500;setTimeout(shimmed.onmousedown,menu_timeout);}
setIframeShim(shim,shimmed);shimmed.style.zIndex=Number(shim.style.zIndex)+1;}
var map_state={};map_state.scrollwheel=map.get('scrollwheel');map.set('scrollwheel',false);if(map.get('zoomControl')!=false){var maps_earth_zoom_control_style={};maps_earth_zoom_control_style[google.maps.ZoomControlStyle.LARGE]=ge.NAVIGATION_CONTROL_LARGE;maps_earth_zoom_control_style[google.maps.ZoomControlStyle.SMALL]=ge.NAVIGATION_CONTROL_SMALL;ge.getNavigationControl().setVisibility(ge.VISIBILITY_AUTO);ge.getNavigationControl().setStreetViewEnabled(map.get('streetViewControl')!==false);var screenxy=ge.getNavigationControl().getScreenXY();screenxy.setXUnits(ge.UNITS_PIXELS);ge.getNavigationControl().setControlType(maps_earth_zoom_control_style[google.maps.ZoomControlStyle.LARGE]);if(map.get('zoomControl')==true){var opts=map.get('zoomControlOptions');if(opts){ge.getNavigationControl().setControlType(maps_earth_zoom_control_style[opts.style]);}}}
map_state.zoomControl=map.get('zoomControl');map.set('zoomControl',false);if(this.get('previousMapTypeId')==google.maps.MapTypeId.HYBRID||this.get('previousMapTypeId')==google.maps.MapTypeId.ROADMAP||this.get('previousMapTypeId')==google.maps.MapTypeId.TERRAIN){ge.getLayerRoot().enableLayerById(ge.LAYER_ROADS,true);ge.getLayerRoot().enableLayerById(ge.LAYER_BORDERS,true);}else{ge.getLayerRoot().enableLayerById(ge.LAYER_ROADS,false);ge.getLayerRoot().enableLayerById(ge.LAYER_BORDERS,false);}
this.jumpToCenter(ge);this.get('container_earth').style.visibility='inherit';this.set('map_state',map_state);this.set('showing',true);};EarthMapType.prototype.jumpToCenter=function(ge){var center=this.get('map').getCenter();var lookat=ge.createLookAt('');lookat.set(center.lat(),center.lng(),0,ge.ALTITUDE_CLAMP_TO_GROUND,0,0,this.mapper.zoomToRange(this.get('map').getZoom()));this._flyToAtSpeed(ge,lookat);lookat.setTilt(30);this._flyToAtSpeed(ge,lookat,1);};EarthMapType.prototype.hide=function(){var ge=this.get('earth_plugin');if(!ge){this.get('container_earth').style.visibility='hidden';this.set('showing',false);return;}
if(this.get('shim')){this.get('shim').style.visibility='hidden';}
var lookat=ge.getView().copyAsLookAt(ge.ALTITUDE_CLAMP_TO_GROUND);var zoom=this.mapper.rangeToZoom(lookat.getRange());var range=this.mapper.zoomToRange(zoom);var map=this.get('map');map.setZoom(zoom);map.setCenter(new google.maps.LatLng(lookat.getLatitude(),lookat.getLongitude()));var transition=false;var self=this;function afterTransition(){var map_state=self.get('map_state');map.set('scrollwheel',map_state.scrollwheel);map.set('zoomControl',map_state.zoomControl);if(transition){google.earth.removeEventListener(ge.getView(),'viewchangeend',arguments.callee);}
self.get('container_earth').style.visibility='hidden';self.set('showing',false);}
if(lookat.getHeading()!=0||lookat.getTilt()!=0||range!=lookat.getRange()){lookat.setRange(range);lookat.setHeading(0);lookat.setTilt(0);transition=true;google.earth.addEventListener(ge.getView(),'viewchangeend',afterTransition);this._flyToAtSpeed(ge,lookat,4.5);}else{afterTransition();}};return EarthMapType;})();Number.prototype.mod=function(n){return((this%n)+n)%n;}
function ETOPOMapType(){}
ETOPOMapType.prototype.name="ETOPO";ETOPOMapType.prototype.alt="ETOPO base map";ETOPOMapType.prototype.tileSize=new google.maps.Size(256,256);ETOPOMapType.prototype.maxZoom=5;ETOPOMapType.prototype.baseURI='http://terra.ucsd.edu/gmaps_tiles/cchdo/';ETOPOMapType.prototype.getTile=function(coord,zoom,ownerDocument){var div=ownerDocument.createElement('DIV');var s=div.style;s.width=this.tileSize.width+'px';s.height=this.tileSize.height+'px';var n=Math.pow(2,zoom);var x=coord.x.mod(n);var y=coord.y;if(y<0||y>n-1){s.background="#000000";}else{s.background=["url('",this.baseURI,"cchdo_z",zoom,"x",x,"y",y,".png')"].join('');}
return div;};function LatLngTooltip(map){this.setMap(map);}
LatLngTooltip.prototype=new google.maps.OverlayView();LatLngTooltip.prototype.onAdd=function(){var self=this;var div=document.createElement('DIV');div.style.border='1px solid #000000';div.style.background='#ffffdd';div.style.padding='0.2em';div.style.position='absolute';div.style.whiteSpace='nowrap';div.style.fontFamily='Helvetica, sans-serif';div.style.fontSize='0.8em';div.style.visibility='hidden';this.getPanes().floatPane.appendChild(div);var lastLatLng=null;var inMap=false;var map=this.getMap();this._moveear=google.maps.event.addListener(map,'mousemove',mousemoved);function mousemoved(mouseevent){var latlng=mouseevent.latLng;lastLatLng=latlng;div.innerHTML=[latlng.lat().toFixed(6),latlng.lng().toFixed(6)].join(', ');position(latlng);}
this._inear=google.maps.event.addListener(map,'mouseover',function(){inMap=true;});this._outear=google.maps.event.addListener(map,'mouseout',function(){inMap=false;});document.onkeydown=function(e){var evt=e||window.event;if(evt.keyCode==16&&inMap){div.style.visibility='visible';if(lastLatLng){position(lastLatLng);}}
if((evt.metaKey||evt.ctrlKey)&&evt.keyCode==67){}};document.onkeyup=function(e){var evt=e||window.event;if(evt.keyCode==16){div.style.visibility='hidden';}};function position(latlng){var px=self.getProjection().fromLatLngToDivPixel(latlng);window.overlay=self;var mapdiv=self.getMap().getDiv();var top=px.y-div.offsetHeight;var left=px.x;var map_width=mapdiv.offsetWidth;if(px.x+div.offsetWidth>map_width){left=px.x-div.offsetWidth;}
div.style.top=top+'px';div.style.left=left+'px';}};LatLngTooltip.prototype.draw=function(){};LatLngTooltip.prototype.onRemove=function(){google.maps.event.removeListener(this._inear);google.maps.event.removeListener(this._moveear);google.maps.event.removeListener(this._outear);};