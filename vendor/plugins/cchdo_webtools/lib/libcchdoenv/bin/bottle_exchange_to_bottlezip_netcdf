#!/srv/webtools/webtools/libcchdoenv/bin/python

from __future__ import with_statement
import sys

import libcchdo as L
import libcchdo.model.datafile
import libcchdo.model.convert.datafile_to_datafilecollection as df2dfc
import libcchdo.formats.bottle.exchange as botex
import libcchdo.formats.bottle.zip.netcdf as botzipnc


def main(argv):
    if len(argv) < 2:
        print 'Usage: %s <bottle exchange zip>' % argv[0]
        return 1
    
    incoming = L.model.datafile.DataFile()
    with open(argv[1], 'r') as in_file:
        botex.read(incoming, in_file)

    botzipnc.write(df2dfc.split_bottle(incoming), sys.stdout)
    return 0


if __name__ == '__main__':
    sys.exit(main(sys.argv))
